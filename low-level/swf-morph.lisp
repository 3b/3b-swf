(in-package :3b-swf)

;;; fixme: factor out the common parts between the foo-*-style-array types

(define-swf-type morph-fill-style-array ()
  :this-var o
  :value-var value
  :auto
  ((fill-style-count () :derived (length (fill-styles o)))
   (fill-styles (counted-list (swf-type 'morph-fill-style)
                              fill-style-count)))
  :reader ((fill-style-count
            (let ((short (ui8)))
              (if (= short #xff)
                  (ui16)
                  short))))
  :sizer ((fill-style-count
           (progn
             (ui8)
             (when (>= value #xff)
               (ui16)))))
  :writer ((fill-style-count
            (if (>= value #xff)
                (progn
                  (let ((value #xff))
                    (ui8))
                  (ui16))
                (ui8))))
  :print-unreadably ("簋［夯哼蔺ㄩ狎蜥痱轭舡鲥蜮矬濯ㄦ殪飙篝戾铹扉篝ъ孱玺戾铉翳ㄦ殪飙篝戾铹┅┅换骈礤汜翳弩忮泔礅轭邃鏖翳铒蝽犰骈祆篝戾ㄤ彐轭瀛篦姝豉疱盹蝠璀骈祆篝戾ī呼栝蟓鲠横豸è骈祆篝戾豉疱蹰俯轰弪轹邃篚忏灬篌殇ы矧痂骈祆篝戾┅后踱沆狍篚忏灬篌骝镯殇ы矧痂骈祆篝戾骈祆篝戾豉疱┅ㄤ彐轭瀛篦姝豉疱盹蝠璀骈祆篝戾箫扉盹蝠璀骈祆篝戾洪ｘ鞍横豸è篝狎舡泔祜篦姝豉疱蜱忉┅ㄥ钿泔祜篦姝豉疱蜱忉┅┅ㄤ彐轭瀛篦姝豉疱盹蝠璀骈祆扉铄狎珧徜殄铘盹蝠璀骈祆篝戾洪ｘ卑横豸è篝狎舡珧徜殄铘磲趄轼篦姝豉疱ы狒蜷┅ㄥ钿珧徜殄铘磲趄轼篦姝豉疱ы狒蜷┅ㄧ蜥溟孱篦姝豉疱ы矧痂珧徜殄铘┅┅ㄤ彐轭瀛篦姝豉疱盹蝠璀骈祆蜥溟犰珧徜殄铘盹蝠璀骈祆篝戾洪ｘ辈横豸è篝狎舡珧徜殄铘磲趄轼篦姝豉疱ы狒蜷┅ㄥ钿珧徜殄铘磲趄轼篦姝豉疱ы狒蜷┅ㄧ蜥溟孱篦姝豉疱ы矧痂珧徜殄铘┅┅ㄤ彐轭瀛篦姝豉疱盹蝠璀骈祆蝈疱狒轭绛忾繇狃骈祆盹蝠璀骈祆篝戾洪ｘ窗横豸è忾繇狃殇蹰倍┅篝狎舡忾繇狃磲趄轼篦姝豉疱ы狒蜷┅ㄥ钿忾繇狃磲趄轼篦姝豉疱ы狒蜷┅┅ㄤ彐轭瀛篦姝豉疱盹蝠璀骈祆沆轲疱洵忾繇狃骈祆盹蝠璀骈祆篝戾洪ｘ幢横豸è忾繇狃殇蹰倍┅篝狎舡忾繇狃磲趄轼篦姝豉疱ы狒蜷┅ㄥ钿忾繇狃磲趄轼篦姝豉疱ы狒蜷┅┅ㄤ彐轭瀛篦姝豉疱盹蝠璀骈祆铒瞽箜镲翳邃蝈疱狒轭绛忾繇狃骈祆盹蝠璀骈祆篝戾洪ｘ床横豸è忾繇狃殇蹰倍┅篝狎舡忾繇狃磲趄轼篦姝豉疱ы狒蜷┅ㄥ钿忾繇狃磲趄轼篦姝豉疱ы狒蜷┅┅ㄤ彐轭瀛篦姝豉疱盹蝠璀骈祆铒瞽箜镲翳邃沆轲疱洵忾繇狃骈祆盹蝠璀骈祆篝戾洪ｘ闯横豸è忾繇狃殇蹰倍┅篝狎舡忾繇狃磲趄轼篦姝豉疱ы狒蜷┅ㄥ钿忾繇狃磲趄轼篦姝豉疱ы狒蜷┅┅ㄤ彐轭瀛篦姝豉疱盹蝠璀珧徜殄铘ī呼栝蟓鲠横豸è铛憝珧徜殄铘蹰俯轰弪轹邃戾铉翳ㄧ蜥溟孱舡蝈泔蜾铹┅ㄧ蜥溟孱舡蝈泔蜾ㄣ秕铘邃扉篝篦姝豉疱ы矧痂珧徜蝈泔蜾铛憝珧徜殄铘螬┅ㄤ彐轭瀛篦姝豉疱盹蝠璀珧徜蝈泔蜾ī横豸è篝狎舡蜥糸蹰俯篝狎舡泔祜篦姝豉疱蜱忉┅ㄥ钿蜥糸蹰俯ㄥ钿泔祜篦姝豉疱蜱忉┅┅换骈礤躞箦疳蜥翦豉疱轭篝遽镦骒徵ㄤ彐鲠盹蝠璀箬狃瀛鲥颡ㄤ彐轭瀛篦姝豉疱盹蝠璀扉铄篝戾狎蜥ī呼栝蟓鲠忽犰蹂鲠鲠祯横豸è扉铄篝戾泔躅ī轰弪轹邃戾铉翳扉铄篝戾铹┅扉铄篝戾ㄣ秕铘邃扉篝篦姝豉疱ㄥ汜箦盹蝠璀箬狃瀛鲥颡ūы矧痂扉铄篝戾úы矧痂扉铄篝戾博┅扉铄篝戾泔躅舂┅候遽溴è扉铄篝戾泔躅戾è箬矧蹰俯┅ㄩ箬矧ｘ骀蹰倍箬矧舂┅后辁弪è扉铄篝戾泔躅痱镧蹰俯麒孱窘鲠祯ｘ骀蹰倍┅┅瑚蜷翦è扉铄篝戾泔躅ㄩ窘鲠祯ｘ骀痱镧戾è鲠祯ｘ骀┅蹰俯蹰倍┅蹰俯┅┅ㄤ彐轭瀛篦姝豉疱盹蝠璀扉铄篝戾ī横豸è篝狎舡鏖漪赭轲蟓醣订ㄥ钿鏖漪赭轲蟓醣订篝狎舡泔祜篦姝豉疱蜱忉┅ㄥ钿泔祜篦姝豉疱蜱忉┅┅ㄤ彐轭瀛篦姝豉疱盹蝠璀扉铄篝戾ī呼栝蟓鲠横豸è篝狎舡鏖漪赭轲蟓醣订ㄥ钿鏖漪赭轲蟓醣订篝狎舡汜瓠篝戾踱博觑轭篝戾踱博ㄨ狍骈祆ㄢ轸骒徵轰弪轹邃铒铛祆ㄦ殪飙豉疱铹┅铒璀筱犰ㄢ轸骒徵┅铒霏筱犰ㄢ轸骒徵┅痖屐栝铘轭ㄢ轸骒徵┅蝈箦蝣邃踱旦铒沆矬ㄢ轸骒徵┅ㄥ钿汜瓠篝戾踱博黹翦颦扉黹舡驷泗矧踱博猴痿轱钺觑轭篝戾博篝狎舡泔祜篦姝豉疱蜱忉猴痿轱钺铒栳蟓骈祆┅ㄥ钿泔祜篦姝豉疱蜱忉猴痿轱钺铒栳蟓骈祆┅ㄦ殪飙豉疱篦姝豉疱ы矧痂骈祆篝戾猴痿轱钺栳蟓骈祆┅